import{e as y,o as l,f as c,h as u,j as m,k as w,b as p,F as C,r as T,c as v,p as M,l as $}from"./entry.9e251ea0.js";import{_ as x}from"./Cell.a2b43ae4.js";import{u as f,o as k,r as d,s as S,g as b}from"./index.b4dc6616.js";const I={emits:["changeDirection"],data:()=>({up:!1,down:!1,right:!1,left:!1}),methods:{moveTo(t,e){this[t]=e,this.$emit("changeDirection",{direction:t,value:e})}},mounted(){console.log("ahhhhhh")}},V={class:"cross-container"};function H(t,e,o,i,r,s){return l(),c("div",V,[u("div",{class:m(["direction-btn",{active:t.up}]),onTouchstart:e[0]||(e[0]=n=>s.moveTo("up",!0)),onMousedown:e[1]||(e[1]=n=>s.moveTo("up",!0)),onTouchend:e[2]||(e[2]=n=>s.moveTo("up",!1)),onMouseup:e[3]||(e[3]=n=>s.moveTo("up",!1)),id:"up"},null,34),u("div",{class:m(["direction-btn",{active:t.down}]),onTouchstart:e[4]||(e[4]=n=>s.moveTo("down",!0)),onMousedown:e[5]||(e[5]=n=>s.moveTo("down",!0)),onTouchend:e[6]||(e[6]=n=>s.moveTo("down",!1)),onMouseup:e[7]||(e[7]=n=>s.moveTo("down",!1)),id:"down"},null,34),u("div",{class:m(["direction-btn",{active:t.right}]),onTouchstart:e[8]||(e[8]=n=>s.moveTo("right",!0)),onMousedown:e[9]||(e[9]=n=>s.moveTo("right",!0)),onTouchend:e[10]||(e[10]=n=>s.moveTo("right",!1)),onMouseup:e[11]||(e[11]=n=>s.moveTo("right",!1)),id:"right"},null,34),u("div",{class:m(["direction-btn",{active:t.left}]),onTouchstart:e[12]||(e[12]=n=>s.moveTo("left",!0)),onMousedown:e[13]||(e[13]=n=>s.moveTo("left",!0)),onTouchend:e[14]||(e[14]=n=>s.moveTo("left",!1)),onMouseup:e[15]||(e[15]=n=>s.moveTo("left",!1)),id:"left"},null,34)])}const D=y(I,[["render",H]]);const F={emits:["changeDirection"],data(){return{xStart:window.innerWidth/2,yStart:window.innerHeight/2,xCircle:window.innerWidth/2,yCircle:window.innerHeight/2,active:!1}},methods:{moveStart(t){this.yStart=t.clientY,this.xStart=t.clientX,this.yCircle=t.clientY,this.xCircle=t.clientX,this.active=!0},move(t){if(this.active){console.log(t);const i=this.yStart-t.clientY,r=this.xStart-t.clientX;var e=Math.min(Math.sqrt(r*r+i*i),100),o=Math.atan2(i,r)*180/Math.PI;this.xCircle=this.xStart+e*-Math.cos(o*Math.PI/180),this.yCircle=this.yStart+e*Math.sin(-o*Math.PI/180),this.$emit("changeDirection",{direction:Math.round(o),value:Math.round(e)})}},moveStop(){this.yStart=window.innerHeight/2,this.xStart=window.innerWidth/2,this.yCircle=window.innerHeight/2,this.xCircle=window.innerWidth/2,this.$emit("changeDirection",{direction:0,value:0}),this.active=!1}}};function q(t,e,o,i,r,s){return l(),c("div",{class:m(["joystick",r.active]),onMousedown:e[0]||(e[0]=(...n)=>s.moveStart&&s.moveStart(...n)),onTouchstart:e[1]||(e[1]=(...n)=>s.moveStart&&s.moveStart(...n)),onMousemove:e[2]||(e[2]=(...n)=>s.move&&s.move(...n)),onTouchmove:e[3]||(e[3]=(...n)=>s.move&&s.move(...n)),onMouseup:e[4]||(e[4]=(...n)=>s.moveStop&&s.moveStop(...n)),onTouchend:e[5]||(e[5]=(...n)=>s.moveStop&&s.moveStop(...n)),onTouchcancel:e[6]||(e[6]=(...n)=>s.moveStop&&s.moveStop(...n))},[u("div",{class:"zone",style:w({top:r.yStart+"px",left:r.xStart+"px"})},null,4),u("div",{class:"circle",style:w({top:r.yCircle+"px",left:r.xCircle+"px"})},null,4)],34)}const B=y(F,[["render",q],["__scopeId","data-v-41c993bb"]]);const R={data(){return{selected:null,grid:[],signs:[],colors:[],mySigns:[]}},props:["myTurn"],emits:["select"],methods:{selectSign(t){this.myTurn&&this.mySigns.length>1&&(this.selected==t?this.selected=null:this.selected=t)},selectCell(t,e){var o;this.myTurn&&(this.selected!=null||this.mySigns.length==1)&&(console.log(this.selectable(t,e)),this.selectable(t,e)&&(this.$emit("select",{index:(o=this.selected)!=null?o:0,x:t,y:e}),this.selected=null))},checkIsCompatible(t,e,o){if(o){if(o.sign="joker")return!0;if(grid[t]&&grid[t][e]){if(grid[t][e].sign=="joker"||grid[t][e].sign=="")return!0;const i=grid[t][e];return console.log(i,o),o.color==i.color||o.sign==i.sign}else return!0}},selectable(t,e){const o=this.selected||this.mySigns.length==1?0:null;return o!=null?(console.log(this.checkIsCompatible(t+1,e,this.mySigns[o]),this.checkIsCompatible(t+1,e,this.mySigns[o]),this.checkIsCompatible(t+1,e,this.mySigns[o]),this.checkIsCompatible(t+1,e,this.mySigns[o])),this.checkIsCompatible(t+1,e,this.mySigns[o])&&this.checkIsCompatible(t+1,e,this.mySigns[o])&&this.checkIsCompatible(t+1,e,this.mySigns[o])&&this.checkIsCompatible(t+1,e,this.mySigns[o])):!1},gridEmpty(){for(const t of this.grid)for(const e of t)if(e.sign)return!1;return!0}},mounted(){const t=f(),e=p();k(d(t,`rooms/${e.params.code}/game/sign/grid`),o=>{o.exists()&&(this.grid=o.val())}),k(d(t,`rooms/${e.params.code}/players/${e.params.slug}/controller/sign/hand`),o=>{o.exists()&&(this.mySigns=o.val(),console.log("ah",this.mySigns))})}},Z=t=>(M("data-v-51958e39"),t=t(),$(),t),j={class:"sign-controller"},E={class:"grid"},W=["onClick"],z={key:1},L={class:"options"},P=Z(()=>u("svg",{class:"trash",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.8333 22H6.16663C5.24663 22 4.49996 21.2533 4.49996 20.3333V7H19.5V20.3333C19.5 21.2533 18.7533 22 17.8333 22ZM10.3333 10.3333C10.3333 9.87333 9.95996 9.5 9.49996 9.5C9.03996 9.5 8.66663 9.87333 8.66663 10.3333V17.8333C8.66663 18.2933 9.03996 18.6667 9.49996 18.6667C9.95996 18.6667 10.3333 18.2933 10.3333 17.8333V10.3333ZM15.3333 10.3333C15.3333 9.87333 14.96 9.5 14.5 9.5C14.04 9.5 13.6666 9.87333 13.6666 10.3333V17.8333C13.6666 18.2933 14.04 18.6667 14.5 18.6667C14.96 18.6667 15.3333 18.2933 15.3333 17.8333V10.3333ZM20.3333 6.16667H3.66663V4.5H8.66663V3.25C8.66663 2.56083 9.22746 2 9.91663 2H14.0833C14.7708 2 15.3333 2.55917 15.3333 3.25V4.5H20.3333V6.16667ZM10.3333 4.5H13.6666V3.66667H10.3333V4.5Z",fill:"black"})],-1));function X(t,e,o,i,r,s){const n=x;return l(),c("div",j,[u("div",E,[(l(!0),c(C,null,T(r.grid,(h,a)=>(l(),c("div",{key:a,class:"row"},[(l(!0),c(C,null,T(h,(_,g)=>(l(),c("div",{key:g,class:m(["cell",{selectable:s.selectable(g,a)}]),onClick:ee=>s.selectCell(g,a)},[_.sign?(l(),c("div",z)):(l(),v(n,{key:0}))],10,W))),128))]))),128))]),u("div",L,[s.gridEmpty?(l(),v(n,{key:0,class:m(["my-sign",{selected:r.selected==0}]),sign:"jocker",onClick:e[0]||(e[0]=h=>s.selectSign(0))},null,8,["class"])):(l(!0),c(C,{key:1},T(r.mySigns,(h,a)=>(l(),v(n,{class:m(["my-sign",{selected:r.selected==a}]),key:a,color:h.color,sign:h.sign,onClick:_=>s.selectSign(a)},null,8,["color","sign","onClick","class"]))),128)),P])])}const Y=y(R,[["render",X],["__scopeId","data-v-51958e39"]]);const J={},G={class:"loader-container"},N=u("div",{class:"loader"},null,-1),A=[N];function K(t,e,o,i,r,s){return l(),c("div",G,A)}const O=y(J,[["render",K]]);const Q={data:()=>({color:"#999999",myTurn:!1,controllerType:"load",touchCount:0}),methods:{cross(t){const e=f(),o=p();S(d(e,`rooms/${o.params.code}/players/${o.params.slug}/controller/cross`),{[t.direction]:t.value})},joystick(t){const e=f(),o=p();S(d(e,`rooms/${o.params.code}/players/${o.params.slug}/controller/joystick`),t)},sign(t){const e=f(),o=p();S(d(e,`rooms/${o.params.code}/players/${o.params.slug}/controller/sign/action`),t)},fullScreen(){const t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},resetTouch(){setTimeout(function(){this.touchCount=0},1e3)},tripleTouch(){this.resetTouch(),this.touchCount+=1,this.touchCount===3&&(this.touchCount=0,this.fullScreen())}},mounted:async function(){const t=f(),e=p(),o=await b(d(t,`rooms/${e.params.code}/players/${e.params.slug}/avatar`));if(o.exists()){const r=o.val();this.color=r.body.color}const i=await b(d(t,`rooms/${e.params.code}/controller`));if(i.exists()){const r=i.val();this.controllerType!=r.type&&S(d(t,`rooms/${e.params.code}/players/${e.params.slug}/controller/${this.controllerType}`),{}),this.controllerType=r.type,this.myTurn=r.turn==null||r.turn==e.params.slug}k(d(t,`rooms/${e.params.code}/controller`),r=>{if(r.exists()){const s=r.val();this.controllerType=s.type,this.myTurn=s.turn==e.params.slug}})}};function U(t,e,o,i,r,s){const n=D,h=B,a=Y,_=O;return l(),c("div",{class:"controller-container",style:w({background:t.color}),onTouchstart:e[0]||(e[0]=(...g)=>s.tripleTouch&&s.tripleTouch(...g))},[t.controllerType=="cross"?(l(),v(n,{key:0,onChangeDirection:s.cross},null,8,["onChangeDirection"])):t.controllerType=="joystick"?(l(),v(h,{key:1,onChangeDirection:s.joystick},null,8,["onChangeDirection"])):t.controllerType=="sign"?(l(),v(a,{key:2,onSelect:s.sign,myTurn:t.myTurn},null,8,["onSelect","myTurn"])):(l(),v(_,{key:3}))],36)}const ne=y(Q,[["render",U]]);export{ne as default};
